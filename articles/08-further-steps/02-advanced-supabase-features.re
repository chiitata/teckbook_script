== Supabaseの高度な機能

本書ではSupabaseの基本的な機能であるデータベース、認証、RLSを中心に使ってきました。しかし、Supabaseにはアプリケーションをさらに強力にするための高度な機能がまだまだあります。ここではその一部を紹介します。

=== Realtime: リアルタイムなUI更新

Supabaseの「Realtime」機能を使うと、データベースの変更をリアルタイムにクライアントに通知させることができます。これにより、他のユーザーが行った操作を、ページをリロードすることなく即座にUIに反映させるといった、インタラクティブな体験を実現できます。

例えば、「他の誰かがお気に入り登録した動画」をリアルタイムで表示する、といった機能が考えられます。

**実装のヒント:**

 1. Supabaseのダッシュボードで、`favorites`テーブルのRealtimeを有効にします。
 2. クライアントサイドで、`supabase.channel(...).on(...).subscribe()`を使って、`favorites`テーブルへの`INSERT`イベントを購読します。

```javascript
# Realtime機能の実装例
const channel = supabase.channel('favorites-feed')
  .on(
    'postgres_changes',
    { event: 'INSERT', schema: 'public', table: 'favorites' },
    (payload) => {
      console.log('New favorite added!', payload.new)
      # ここでUIを更新する処理（例: トースト通知を表示）
    }
  )
  .subscribe()
```

この機能を使えば、チャットアプリケーションや共同編集ツールなど、より動的なアプリケーションを構築できます。

=== Edge Functions: サーバーサイドロジックの実行

「Edge Functions」は、Denoで書かれたTypeScriptのコードを、サーバーレス環境で実行できる機能です。通常、クライアントから直接実行されたくない、あるいは実行できないような、より複雑なサーバーサイドロジックを実装するのに使います。

例えば、以下のようなケースで役立ちます。

 * **外部APIとの連携**: クライアントに公開したくないAPIキーを使って、外部のサービスと連携する。
 * **複雑なデータ処理**: 複数のテーブルにまたがるような、重いデータベース処理を実行する。
 * **Stripeを使った決済処理**: 決済サービスStripeと連携し、支払い処理を実行する。

Edge Functionsは、世界中のエッジロケーション（ユーザーに近いサーバー）で実行されるため、非常に高速に応答を返すことができます。

=== Storage: ファイルストレージ

本書では扱いませんでしたが、Supabaseには「Storage」という、画像や動画、PDFなどの大容量ファイルを保存するための機能もあります。

例えば、ユーザーがプロフィール画像をアップロードする機能を実装したい場合に、このStorageを利用します。Storageもデータベースと同様に、RLSのような詳細なアクセスポリシーを設定でき、「自分のフォルダにしかアップロードできない」「他人のファイルは閲覧はできるが削除はできない」といった制御が可能です。

=== さらなる学習のために

ここで紹介した機能はほんの一部です。Supabaseの公式ドキュメントは非常に充実しており、各機能の詳細な使い方やチュートリアルが豊富に用意されています。

 * [Supabase Documentation](https://supabase.com/docs)

本書で基本をマスターしたあなたなら、ドキュメントを読み解きながら、これらの高度な機能を自分のアプリケーションに組み込んでいくことができるはずです。ぜひ挑戦してみてください。
